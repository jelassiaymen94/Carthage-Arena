{% extends 'base.html.twig' %}

{% block title %}Tableau de Bord - Carthage Arena{% endblock %}

{% block body %}
<div class="app-container">
    {% include 'components/_sidebar.html.twig' %}

    <main class="main-content">
        <div class="top-bar">
            <div class="page-header">
                <h1 class="page-title">Tableau de Bord</h1>
                <p class="page-subtitle">Bon retour, Champion.</p>
            </div>

            <div class="user-profile-bar">
                <div class="notification-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                    </svg>
                    <span class="notification-badge">3</span>
                </div>

                <div class="user-info">
                    <div>
                        <div class="user-name">{{ user.name }}</div>
                        <div class="user-role">{{ user.role }}</div>
                    </div>
                    <div class="user-balance">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <circle cx="12" cy="12" r="10"></circle>
                        </svg>
                        {{ user.balance }} CP
                    </div>
                    <img src="{{ user.avatar }}" alt="{{ user.name }}" class="user-avatar">
                </div>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                        <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                        <path d="M4 22h16"></path>
                        <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                        <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                        <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
                    </svg>
                </div>
                <div class="stat-label">Rang Actuel</div>
                <div class="stat-value">{{ user.rank }}</div>
                <div class="stat-meta">
                    <div style="background: var(--color-bg-tertiary); height: 6px; border-radius: 3px; overflow: hidden; margin-top: 8px;">
                        <div style="background: var(--gradient-primary); height: 100%; width: {{ user.rankProgress }}%;"></div>
                    </div>
                    <div style="margin-top: 4px; font-size: 12px;">{{ user.rankProgress }}/100 LP</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, #FF0022 0%, #CC001C 100%);">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                </div>
                <div class="stat-label">Matchs Joués</div>
                <div class="stat-value">{{ user.matchesPlayed }}</div>
                <div class="stat-meta">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="var(--color-success)" stroke-width="2">
                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                    </svg>
                    +12 cette semaine
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, #00FF88 0%, #00CC6E 100%);">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                </div>
                <div class="stat-label">Taux de Victoire</div>
                <div class="stat-value">{{ user.winRate }}%</div>
                <div class="stat-meta">Top 5% des joueurs</div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Prochains Matchs</h2>
                <a href="{{ path('app_tournaments') }}" class="text-primary" style="font-size: 0.875rem; font-weight: 600;">
                    Voir Tout
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; vertical-align: middle;">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </a>
            </div>

            <div style="display: flex; flex-direction: column; gap: 1rem;">
                {% for match in upcomingMatches %}
                <div style="background: var(--color-bg-tertiary); border: 1px solid var(--color-border); border-radius: var(--radius-lg); padding: 1.5rem; display: flex; align-items: center; justify-content: space-between; transition: all 0.25s ease;">
                    <div style="display: flex; align-items: center; gap: 1.5rem;">
                        <img src="{{ match.logo }}" alt="{{ match.opponent }}" style="width: 48px; height: 48px; border-radius: 8px;">
                        <div>
                            <div style="font-size: 0.75rem; color: var(--color-text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px;">
                                {{ match.tournament }}
                            </div>
                            <div style="font-size: 1.125rem; font-weight: 700; margin-bottom: 4px;">
                                vs. {{ match.opponent }}
                            </div>
                            <div style="font-size: 0.875rem; color: var(--color-text-secondary);">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; vertical-align: middle; margin-right: 4px;">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                                {{ match.date }}
                            </div>
                        </div>
                    </div>

                    <div style="text-align: right;">
                        <div style="margin-bottom: 8px;">
                            <span class="badge badge-season">{{ match.format }}</span>
                        </div>
                        <div style="font-size: 0.875rem; color: var(--color-text-secondary);">
                            {% if match.maps is defined %}
                                Cartes: {{ match.maps }}
                            {% elseif match.prize is defined %}
                                Cagnotte: {{ match.prize }}
                            {% elseif match.region is defined %}
                                Région: {{ match.region }}
                            {% endif %}
                        </div>
                        <button class="btn btn-primary" style="margin-top: 12px; padding: 0.5rem 1.5rem;">
                            Détails
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </main>
</div>
{% endblock %}
