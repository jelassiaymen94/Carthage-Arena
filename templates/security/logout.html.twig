{% extends 'base.html.twig' %}

{% block title %}Carthage Arena - Déconnexion{% endblock %}

{% block body_class %}bg-background-dark text-white font-display min-h-screen flex items-center justify-center p-4{% endblock %}

{% block body %}
    <div
      id="mainContent"
      class="contents opacity-0 transition-opacity duration-500"
    >
      <div class="relative z-10 flex flex-col items-center gap-4 text-gray-400">
        <div class="w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin"></div>
        <p class="text-sm">Déconnexion en cours...</p>
      </div>
    </div>
{% endblock %}

{% block clerk_script %}
    <script>
      (function() {
        const clerkKey = '{{ clerk_publishable_key|default("") }}';
        if (!clerkKey || clerkKey.indexOf('your-clerk') !== -1) {
          window.location.href = '{{ path("app_login") }}';
          return;
        }

        const script = document.createElement('script');
        script.setAttribute('data-clerk-publishable-key', clerkKey);
        script.async = true;
        script.src = 'https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js';
        script.addEventListener('load', async function() {
          await window.Clerk.load();
          await window.Clerk.signOut();
          window.location.href = '{{ path("app_login") }}';
        });
        document.head.appendChild(script);
      })();
    </script>
{% endblock %}
